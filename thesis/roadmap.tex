\section*{Road Map}


\begin{itemize}
\item \color{green}Create the KD-tree from points on the GPU \checkmark
\item Visualize the KD-tree (as part of debugging), draw frame around
  splitting plane in color corrosponding to splitting axis. (\checkmark)
\item Extend KD-tree to work on triangles \checkmark
\item raytrace the triangle KD-tree \checkmark
\item Add a balanced tree lower node creator \checkmark
\item Reduce more than 1024 segments \checkmark
\item Add empty space splitting
  \begin{itemize}
    \item Extend CreateUpperChildren with the possibility to use indices \checkmark
    \item Copy aabb to lower nodes \checkmark
    \item In reduce, compare the existing aabb with the reduced. \checkmark
    \item Move the nodes by the amount of emptySplitNodes, create the
      empty split nodes in front of the nodes and link them with the
      previous nodes parents.\\ Remember to update segments (used when
      splitting triangles), node size and activeIndex. \checkmark
    \item \color{red}Make dynamic empty space threshold. Higher probability of
      splits at the top, than bottom.
    \item PROFIT
  \end{itemize}
\item Optimize GeometryList
  \begin{itemize}
  \item Removed OpenGL and use device arrays instead. Oh such clean
    geometry collection code. \checkmark
  \end{itemize}
\item Partition the screen into 4x4 ray blocks to improve ray
  traversel coalescenece. \checkmark
\color{red}\item Using indices in lower nodes means child creation will be
  coalesced. Does it mean anything? (Debug malloc\_error, probably
  cudppCompacts handling of numValid)
\item Add persistent threads to the ray tracer and SAH kernels
\item Add triangle split / divide.
\item Use triangle-box intersection to remove ``impossible to hit''
  triangles from the lower nodes. Aabb might need to be propagated
  downwards in order to do this.
\end{itemize}

If time allows

\begin{itemize}
\item Add shadow rays
\item Add an oscilating surface with nice refraction!!
\item Look into SAH approximations
\item Optimize segmented reduce. (low low priority)
\end{itemize}



\subsection*{Trier}

Hurtige SAH beregninger? Wald?

Ray tracing optimeringer de har brugt? Short stack.


\subsection*{Sangild}

Smide pointere op som constant vars, hvorfor virker det ikke.

Forskel på cudaArray og ``almindelige'' arrays

Mulighed for at bruge cuda arrays direkte i gl?

Hvordan bruger jeg profileren? (Måske cpvc ved det)

Bank conflicts.

Gemme float og int i samme 4 entry struct, eg. int4.

Er NVidia gået væk fra SIMD instruktioner? Så 4 float er ligeså
hurtige som float4?
