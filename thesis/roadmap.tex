\section*{Road Map}


\begin{itemize}
\item \color{green}Create the KD-tree from points on the GPU \checkmark
\item Visualize the KD-tree (as part of debugging), draw frame around
  splitting plane in color corrosponding to splitting axis. (\checkmark)
\item Extend KD-tree to work on triangles \checkmark
\item raytrace the triangle KD-tree \checkmark
\item Add a balanced tree lower node creator \checkmark
\item Reduce more than 1024 segments \checkmark
\item Add empty space splitting
  \begin{itemize}
    \item Extend CreateUpperChildren with the possibility to use indices \checkmark
    \item Copy aabb to lower nodes \checkmark
    \item In reduce, compare the existing aabb with the reduced. \checkmark
    \item Move the nodes by the amount of emptySplitNodes, create the
      empty split nodes in front of the nodes and link them with the
      previous nodes parents.\\ Remember to update segments (used when
      splitting triangles), node size and activeIndex. \checkmark
    \item \color{red}Make dynamic empty space threshold. Higher probability of
      splits at the top, than bottom.
    \item PROFIT
  \end{itemize}
\item Optimize GeometryList
  \begin{itemize}
  \item Removed OpenGL and use device arrays instead. Oh such clean
    geometry collection code. \checkmark
  \end{itemize}
\item Partition the screen into 8x4 ray blocks to improve ray
  traversel coalescenece. \checkmark
\color{red} \item Use triangle-box intersection to remove ``impossible to hit''
  triangles from the lower nodes. Aabb might need to be propagated
  downwards in order to do this.
\item Add triangle split / divide. Triangle split can possibly gain
  some performance, by always doing the ``2 triangles'' side first.
\item Split raytracing and coloring into 2 kernels to save on register
  usage for at least on of them (hopefully more threads while
  tracing). Allow a max amount of bounces and let the last ray search
  for an opaque primitive.
\item Make colors float instead of char. Removes 4 divisions when coloring.
\item Use inverse ray dir instead of dir? Replaces a division with
  multiplication. Will probably do nothing since I'm databound.
\item Add Persistent Theads to SAH. Extend it with preemtively
  replacing dead threads every 4 or so cycle.
\item Add persistent threads to the ray tracer
\end{itemize}

If time allows

\begin{itemize}
\item Add shadow rays
\item Add an oscilating surface with nice refraction!!
\item Look into SAH approximations
\item Optimize segmented reduce. (low low priority)
\end{itemize}




\subsection*{Sangild}

Hvordan bruger jeg profileren? (Måske cpvc ved det)

Bank conflicts.

====

Occupancy

Primære og sekundære kilder? Both good. Just quote responsibly (page
number, section, something)

Slå register usage op på runtime
